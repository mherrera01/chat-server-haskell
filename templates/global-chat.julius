var url = document.URL,
    chatMessages = document.getElementById("chat-messages-list"),
    sendMessage = document.getElementById("send-message-form"),
    messageInput = document.getElementById("message-input"),
    conn;

url = url.replace("http:", "ws:").replace("https:", "wss:");
conn = new WebSocket(url);

conn.onmessage = function(e) {
    var msg = document.createElement("li");
    msg.appendChild(document.createTextNode(e.data));
    chatMessages.appendChild(msg);
};

/**
 * The submit event fires when the user clicks the send button
 * or presses Enter while editing the message input field in the form.
 */
sendMessage.addEventListener("submit", function(e) {
    conn.send(messageInput.value);
    messageInput.value = "";
    e.preventDefault();
});
